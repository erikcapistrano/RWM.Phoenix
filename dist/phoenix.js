/*
Resorts World Manila API v.1.0.4
https://phoenix.rwmanila.com
(c) 2014 by it.appdev@rwmanila.com. All rights reserved.

Scroll Down. This JS library is dependent on CryptoJS, easyXDM & a standardized xmlhttprequest, plus polyfills for the JSON Object & the Console Object.

*/
// CryptoJS v3.1.2 code.google.com/p/crypto-js (c) 2009-2013 by Jeff Mott. All rights reserved; code.google.com/p/crypto-js/wiki/License
var CryptoJS = CryptoJS || function (p, z) { var w = {}, v = w.lib = {}, b = function () { }, d = v.Base = { extend: function (f) { b.prototype = this; var g = new b; f && g.mixIn(f); g.hasOwnProperty("init") || (g.init = function () { g.$super.init.apply(this, arguments) }); g.init.prototype = g; g.$super = this; return g }, create: function () { var f = this.extend(); f.init.apply(f, arguments); return f }, init: function () { }, mixIn: function (f) { for (var g in f) { f.hasOwnProperty(g) && (this[g] = f[g]) } f.hasOwnProperty("toString") && (this.toString = f.toString) }, clone: function () { return this.init.prototype.extend(this) } }, a = v.WordArray = d.extend({ init: function (f, g) { f = this.words = f || []; this.sigBytes = g != z ? g : 4 * f.length }, toString: function (f) { return (f || i).stringify(this) }, concat: function (g) { var k = this.words, j = g.words, f = this.sigBytes; g = g.sigBytes; this.clamp(); if (f % 4) { for (var h = 0; h < g; h++) { k[f + h >>> 2] |= (j[h >>> 2] >>> 24 - 8 * (h % 4) & 255) << 24 - 8 * ((f + h) % 4) } } else { if (65535 < j.length) { for (h = 0; h < g; h += 4) { k[f + h >>> 2] = j[h >>> 2] } } else { k.push.apply(k, j) } } this.sigBytes += g; return this }, clamp: function () { var f = this.words, g = this.sigBytes; f[g >>> 2] &= 4294967295 << 32 - 8 * (g % 4); f.length = p.ceil(g / 4) }, clone: function () { var f = d.clone.call(this); f.words = this.words.slice(0); return f }, random: function (f) { for (var h = [], g = 0; g < f; g += 4) { h.push(4294967296 * p.random() | 0) } return new a.init(h, f) } }), e = w.enc = {}, i = e.Hex = { stringify: function (g) { var k = g.words; g = g.sigBytes; for (var j = [], f = 0; f < g; f++) { var h = k[f >>> 2] >>> 24 - 8 * (f % 4) & 255; j.push((h >>> 4).toString(16)); j.push((h & 15).toString(16)) } return j.join("") }, parse: function (g) { for (var j = g.length, h = [], f = 0; f < j; f += 2) { h[f >>> 3] |= parseInt(g.substr(f, 2), 16) << 24 - 4 * (f % 8) } return new a.init(h, j / 2) } }, c = e.Latin1 = { stringify: function (g) { var j = g.words; g = g.sigBytes; for (var h = [], f = 0; f < g; f++) { h.push(String.fromCharCode(j[f >>> 2] >>> 24 - 8 * (f % 4) & 255)) } return h.join("") }, parse: function (g) { for (var j = g.length, h = [], f = 0; f < j; f++) { h[f >>> 2] |= (g.charCodeAt(f) & 255) << 24 - 8 * (f % 4) } return new a.init(h, j) } }, o = e.Utf8 = { stringify: function (f) { try { return decodeURIComponent(escape(c.stringify(f))) } catch (g) { throw Error("Malformed UTF-8 data") } }, parse: function (f) { return c.parse(unescape(encodeURIComponent(f))) } }, x = v.BufferedBlockAlgorithm = d.extend({ reset: function () { this._data = new a.init; this._nDataBytes = 0 }, _append: function (f) { "string" == typeof f && (f = o.parse(f)); this._data.concat(f); this._nDataBytes += f.sigBytes }, _process: function (j) { var q = this._data, n = q.words, h = q.sigBytes, m = this.blockSize, l = h / (4 * m), l = j ? p.ceil(l) : p.max((l | 0) - this._minBufferSize, 0); j = l * m; h = p.min(4 * j, h); if (j) { for (var k = 0; k < j; k += m) { this._doProcessBlock(n, k) } k = n.splice(0, j); q.sigBytes -= h } return new a.init(k, h) }, clone: function () { var f = d.clone.call(this); f._data = this._data.clone(); return f }, _minBufferSize: 0 }); v.Hasher = x.extend({ cfg: d.extend(), init: function (f) { this.cfg = this.cfg.extend(f); this.reset() }, reset: function () { x.reset.call(this); this._doReset() }, update: function (f) { this._append(f); this._process(); return this }, finalize: function (f) { f && this._append(f); return this._doFinalize() }, blockSize: 16, _createHelper: function (f) { return function (h, g) { return (new f.init(g)).finalize(h) } }, _createHmacHelper: function (f) { return function (h, g) { return (new y.HMAC.init(f, g)).finalize(h) } } }); var y = w.algo = {}; return w } (Math); (function (v) { for (var B = CryptoJS, x = B.lib, w = x.WordArray, c = x.Hasher, x = B.algo, e = [], b = [], i = function (f) { return 4294967296 * (f - (f | 0)) | 0 }, o = 2, d = 0; 64 > d; ) { var p; y: { p = o; for (var z = v.sqrt(p), A = 2; A <= z; A++) { if (!(p % A)) { p = !1; break y } } p = !0 } p && (8 > d && (e[d] = i(v.pow(o, 0.5))), b[d] = i(v.pow(o, 1 / 3)), d++); o++ } var y = [], x = x.SHA256 = c.extend({ _doReset: function () { this._hash = new w.init(e.slice(0)) }, _doProcessBlock: function (J, I) { for (var K = this._hash.words, H = K[0], G = K[1], F = K[2], D = K[3], E = K[4], t = K[5], s = K[6], a = K[7], r = 0; 64 > r; r++) { if (16 > r) { y[r] = J[I + r] | 0 } else { var C = y[r - 15], u = y[r - 2]; y[r] = ((C << 25 | C >>> 7) ^ (C << 14 | C >>> 18) ^ C >>> 3) + y[r - 7] + ((u << 15 | u >>> 17) ^ (u << 13 | u >>> 19) ^ u >>> 10) + y[r - 16] } C = a + ((E << 26 | E >>> 6) ^ (E << 21 | E >>> 11) ^ (E << 7 | E >>> 25)) + (E & t ^ ~E & s) + b[r] + y[r]; u = ((H << 30 | H >>> 2) ^ (H << 19 | H >>> 13) ^ (H << 10 | H >>> 22)) + (H & G ^ H & F ^ G & F); a = s; s = t; t = E; E = D + C | 0; D = F; F = G; G = H; H = C + u | 0 } K[0] = K[0] + H | 0; K[1] = K[1] + G | 0; K[2] = K[2] + F | 0; K[3] = K[3] + D | 0; K[4] = K[4] + E | 0; K[5] = K[5] + t | 0; K[6] = K[6] + s | 0; K[7] = K[7] + a | 0 }, _doFinalize: function () { var g = this._data, j = g.words, f = 8 * this._nDataBytes, h = 8 * g.sigBytes; j[h >>> 5] |= 128 << 24 - h % 32; j[(h + 64 >>> 9 << 4) + 14] = v.floor(f / 4294967296); j[(h + 64 >>> 9 << 4) + 15] = f; g.sigBytes = 4 * j.length; this._process(); return this._hash }, clone: function () { var f = c.clone.call(this); f._hash = this._hash.clone(); return f } }); B.SHA256 = c._createHelper(x); B.HmacSHA256 = c._createHmacHelper(x) })(Math); (function () { var b = CryptoJS, a = b.enc.Utf8; b.algo.HMAC = b.lib.Base.extend({ init: function (t, s) { t = this._hasher = new t.init; "string" == typeof s && (s = a.parse(s)); var q = t.blockSize, e = 4 * q; s.sigBytes > e && (s = t.finalize(s)); s.clamp(); for (var c = this._oKey = s.clone(), i = this._iKey = s.clone(), o = c.words, d = i.words, p = 0; p < q; p++) { o[p] ^= 1549556828, d[p] ^= 909522486 } c.sigBytes = i.sigBytes = e; this.reset() }, reset: function () { var c = this._hasher; c.reset(); c.update(this._iKey) }, update: function (c) { this._hasher.update(c); return this }, finalize: function (d) { var c = this._hasher; d = c.finalize(d); c.reset(); return c.finalize(this._oKey.clone().concat(d)) } }) })(); (function () { var b = CryptoJS, a = b.lib.WordArray; b.enc.Base64 = { stringify: function (h) { var l = h.words, k = h.sigBytes, n = this._map; h.clamp(); h = []; for (var i = 0; i < k; i += 3) { for (var m = (l[i >>> 2] >>> 24 - 8 * (i % 4) & 255) << 16 | (l[i + 1 >>> 2] >>> 24 - 8 * ((i + 1) % 4) & 255) << 8 | l[i + 2 >>> 2] >>> 24 - 8 * ((i + 2) % 4) & 255, j = 0; 4 > j && i + 0.75 * j < k; j++) { h.push(n.charAt(m >>> 6 * (3 - j) & 63)) } } if (l = n.charAt(64)) { for (; h.length % 4; ) { h.push(l) } } return h.join("") }, parse: function (i) { var n = i.length, m = this._map, p = m.charAt(64); p && (p = i.indexOf(p), -1 != p && (n = p)); for (var p = [], j = 0, o = 0; o < n; o++) { if (o % 4) { var l = m.indexOf(i.charAt(o - 1)) << 2 * (o % 4), k = m.indexOf(i.charAt(o)) >>> 6 - 2 * (o % 4); p[j >>> 2] |= (l | k) << 24 - 8 * (j % 4); j++ } } return a.create(p, j) }, _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="} })();
// json2.js github.com/douglascrockford/JSON-js 2010-11-18 by Douglas Crockford; Public Domain
if (typeof JSON !== "object") { JSON = {} } (function () { function f(n) { return n < 10 ? "0" + n : n } if (typeof Date.prototype.toJSON !== "function") { Date.prototype.toJSON = function (key) { return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null }; String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function (key) { return this.valueOf() } } var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep; function quote(string) { escapable.lastIndex = 0; return escapable.test(string) ? '"' + string.replace(escapable, function (a) { var c = meta[a]; return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + string + '"' } function str(key, holder) { var i, k, v, length, mind = gap, partial, value = holder[key]; if (value && typeof value === "object" && typeof value.toJSON === "function") { value = value.toJSON(key) } if (typeof rep === "function") { value = rep.call(holder, key, value) } switch (typeof value) { case "string": return quote(value); case "number": return isFinite(value) ? String(value) : "null"; case "boolean": case "null": return String(value); case "object": if (!value) { return "null" } gap += indent; partial = []; if (Object.prototype.toString.apply(value) === "[object Array]") { length = value.length; for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || "null" } v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]"; gap = mind; return v } if (rep && typeof rep === "object") { length = rep.length; for (i = 0; i < length; i += 1) { if (typeof rep[i] === "string") { k = rep[i]; v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v) } } } } else { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v) } } } } v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}"; gap = mind; return v } } if (typeof JSON.stringify !== "function") { JSON.stringify = function (value, replacer, space) { var i; gap = ""; indent = ""; if (typeof space === "number") { for (i = 0; i < space; i += 1) { indent += " " } } else { if (typeof space === "string") { indent = space } } rep = replacer; if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) { throw new Error("JSON.stringify") } return str("", { "": value }) } } if (typeof JSON.parse !== "function") { JSON.parse = function (text, reviver) { var j; function walk(holder, key) { var k, v, value = holder[key]; if (value && typeof value === "object") { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = walk(value, k); if (v !== undefined) { value[k] = v } else { delete value[k] } } } } return reviver.call(holder, key, value) } text = String(text); cx.lastIndex = 0; if (cx.test(text)) { text = text.replace(cx, function (a) { return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4) }) } if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) { j = eval("(" + text + ")"); return typeof reviver === "function" ? walk({ "": j }, "") : j } throw new SyntaxError("JSON.parse") } } } ());
// Console Fix www.twitter.com (c) 2012 Twitter, Inc. All rights reserved.
if (!window.console) { (function () { var names = ["log", "debug", "info", "warn", "error", "assert", "dir", "dirxml", "group", "groupEnd", "time", "timeEnd", "count", "trace", "profile", "profileEnd"], i, l = names.length; window.console = {}; for (i = 0; i < l; i++) { window.console[names[i]] = function () { }; } } ()); }
// XMLHttpRequest.js https://github.com/ilinsky/xmlhttprequest (C) 2011 Sergey Ilinsky All rights reserved; GNU Lesser General Public License
(function () { var g = window.XMLHttpRequest; var a = !!window.controllers; var j = !!window.document.namespaces; var k = j && window.navigator.userAgent.match(/MSIE 7.0/); function d() { this._object = g && !k ? new g : new window.ActiveXObject("Microsoft.XMLHTTP"); this._listeners = [] } function c() { return new d } c.prototype = d.prototype; if (a && g.wrapped) { c.wrapped = g.wrapped } c.UNSENT = 0; c.OPENED = 1; c.HEADERS_RECEIVED = 2; c.LOADING = 3; c.DONE = 4; c.prototype.UNSENT = c.UNSENT; c.prototype.OPENED = c.OPENED; c.prototype.HEADERS_RECEIVED = c.HEADERS_RECEIVED; c.prototype.LOADING = c.LOADING; c.prototype.DONE = c.DONE; c.prototype.readyState = c.UNSENT; c.prototype.responseText = ""; c.prototype.responseXML = null; c.prototype.status = 0; c.prototype.statusText = ""; c.prototype.priority = "NORMAL"; c.prototype.onreadystatechange = null; c.onreadystatechange = null; c.onopen = null; c.onsend = null; c.onabort = null; c.prototype.open = function (q, m, o, s, p) { var l = q.toLowerCase(); if (l == "connect" || l == "trace" || l == "track") { throw new Error(18) } delete this._headers; if (arguments.length < 3) { o = true } this._async = o; var n = this; var r = this.readyState; var t = null; if (j && o) { t = function () { if (r != c.DONE) { e(n); n.abort() } }; window.attachEvent("onunload", t) } if (c.onopen) { c.onopen.apply(this, arguments) } if (arguments.length > 4) { this._object.open(q, m, o, s, p) } else { if (arguments.length > 3) { this._object.open(q, m, o, s) } else { this._object.open(q, m, o) } } this.readyState = c.OPENED; b(this); this._object.onreadystatechange = function () { if (a && !o) { return } n.readyState = n._object.readyState; h(n); if (n._aborted) { n.readyState = c.UNSENT; return } if (n.readyState == c.DONE) { delete n._data; e(n); if (j && o) { window.detachEvent("onunload", t) } if (r != n.readyState) { b(n) } r = n.readyState } } }; c.prototype.send = function (l) { if (c.onsend) { c.onsend.apply(this, arguments) } if (!arguments.length) { l = null } if (l && l.nodeType) { l = window.XMLSerializer ? new window.XMLSerializer().serializeToString(l) : l.xml; if (!this._headers["Content-Type"]) { this._object.setRequestHeader("Content-Type", "application/xml") } } this._data = l; f(this) }; c.prototype.abort = function () { if (c.onabort) { c.onabort.apply(this, arguments) } if (this.readyState > c.UNSENT) { this._aborted = true } this._object.abort(); e(this); this.readyState = c.UNSENT; delete this._data }; c.prototype.getAllResponseHeaders = function () { return this._object.getAllResponseHeaders() }; c.prototype.getResponseHeader = function (l) { return this._object.getResponseHeader(l) }; c.prototype.setRequestHeader = function (l, m) { if (!this._headers) { this._headers = {} } this._headers[l] = m; return this._object.setRequestHeader(l, m) }; c.prototype.addEventListener = function (o, n, m) { for (var l = 0, p; p = this._listeners[l]; l++) { if (p[0] == o && p[1] == n && p[2] == m) { return } } this._listeners.push([o, n, m]) }; c.prototype.removeEventListener = function (o, n, m) { for (var l = 0, p; p = this._listeners[l]; l++) { if (p[0] == o && p[1] == n && p[2] == m) { break } } if (p) { this._listeners.splice(l, 1) } }; c.prototype.dispatchEvent = function (m) { var n = { type: m.type, target: this, currentTarget: this, eventPhase: 2, bubbles: m.bubbles, cancelable: m.cancelable, timeStamp: m.timeStamp, stopPropagation: function () { }, preventDefault: function () { }, initEvent: function () { } }; if (n.type == "readystatechange" && this.onreadystatechange) { (this.onreadystatechange.handleEvent || this.onreadystatechange).apply(this, [n]) } for (var l = 0, o; o = this._listeners[l]; l++) { if (o[0] == n.type && !o[2]) { (o[1].handleEvent || o[1]).apply(this, [n]) } } }; c.prototype.toString = function () { return "[object XMLHttpRequest]" }; c.toString = function () { return "[XMLHttpRequest]" }; function f(l) { l._object.send(l._data); if (a && !l._async) { l.readyState = c.OPENED; h(l); while (l.readyState < c.DONE) { l.readyState++; b(l); if (l._aborted) { return } } } } function b(l) { if (c.onreadystatechange) { c.onreadystatechange.apply(l) } l.dispatchEvent({ type: "readystatechange", bubbles: false, cancelable: false, timeStamp: new Date + 0 }) } function i(n) { var m = n.responseXML; var l = n.responseText; if (j && l && m && !m.documentElement && n.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)) { m = new window.ActiveXObject("Microsoft.XMLDOM"); m.async = false; m.validateOnParse = false; m.loadXML(l) } if (m) { if ((j && m.parseError !== 0) || !m.documentElement || (m.documentElement && m.documentElement.tagName == "parsererror")) { return null } } return m } function h(l) { try { l.responseText = l._object.responseText } catch (m) { } try { l.responseXML = i(l._object) } catch (m) { } try { l.status = l._object.status } catch (m) { } try { l.statusText = l._object.statusText } catch (m) { } } function e(l) { l._object.onreadystatechange = new window.Function } if (!window.Function.prototype.apply) { window.Function.prototype.apply = function (l, m) { if (!m) { m = [] } l.__func = this; l.__func(m[0], m[1], m[2], m[3], m[4]); delete l.__func } } window.XMLHttpRequest = c })();
// easyXDM github.com/oyvindkinsey/easyXDM (c) 2009-2011 Ã˜yvind Sean Kinsey, oyvind@kinsey.no. All rights reserved; MIT license
(function (N, d, p, K, k, H) { var b = this; var n = Math.floor(Math.random() * 10000); var q = Function.prototype; var Q = /^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/; var R = /[\-\w]+\/\.\.\//; var F = /([^:])\/\//g; var I = ""; var o = {}; var M = N.easyXDM; var U = "easyXDM_"; var E; var y = false; var i; var h; function C(X, Z) { var Y = typeof X[Z]; return Y == "function" || (!!(Y == "object" && X[Z])) || Y == "unknown" } function u(X, Y) { return !!(typeof (X[Y]) == "object" && X[Y]) } function r(X) { return Object.prototype.toString.call(X) === "[object Array]" } function c() { var Z = "Shockwave Flash", ad = "application/x-shockwave-flash"; if (!t(navigator.plugins) && typeof navigator.plugins[Z] == "object") { var ab = navigator.plugins[Z].description; if (ab && !t(navigator.mimeTypes) && navigator.mimeTypes[ad] && navigator.mimeTypes[ad].enabledPlugin) { i = ab.match(/\d+/g) } } if (!i) { var Y; try { Y = new ActiveXObject("ShockwaveFlash.ShockwaveFlash"); i = Array.prototype.slice.call(Y.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/), 1); Y = null } catch (ac) { } } if (!i) { return false } var X = parseInt(i[0], 10), aa = parseInt(i[1], 10); h = X > 9 && aa > 0; return true } var v, x; if (C(N, "addEventListener")) { v = function (Z, X, Y) { Z.addEventListener(X, Y, false) }; x = function (Z, X, Y) { Z.removeEventListener(X, Y, false) } } else { if (C(N, "attachEvent")) { v = function (X, Z, Y) { X.attachEvent("on" + Z, Y) }; x = function (X, Z, Y) { X.detachEvent("on" + Z, Y) } } else { throw new Error("Browser not supported") } } var W = false, J = [], L; if ("readyState" in d) { L = d.readyState; W = L == "complete" || (~navigator.userAgent.indexOf("AppleWebKit/") && (L == "loaded" || L == "interactive")) } else { W = !!d.body } function s() { if (W) { return } W = true; for (var X = 0; X < J.length; X++) { J[X]() } J.length = 0 } if (!W) { if (C(N, "addEventListener")) { v(d, "DOMContentLoaded", s) } else { v(d, "readystatechange", function () { if (d.readyState == "complete") { s() } }); if (d.documentElement.doScroll && N === top) { var g = function () { if (W) { return } try { d.documentElement.doScroll("left") } catch (X) { K(g, 1); return } s() }; g() } } v(N, "load", s) } function G(Y, X) { if (W) { Y.call(X); return } J.push(function () { Y.call(X) }) } function m() { var Z = parent; if (I !== "") { for (var X = 0, Y = I.split("."); X < Y.length; X++) { Z = Z[Y[X]] } } return Z.easyXDM } function e(X) { N.easyXDM = M; I = X; if (I) { U = "easyXDM_" + I.replace(".", "_") + "_" } return o } function z(X) { return X.match(Q)[3] } function f(X) { return X.match(Q)[4] || "" } function j(Z) { if (/^file/.test(Z)) { throw new Error("The file:// protocol is not supported"); } var X = Z.toLowerCase().match(Q); var aa = X[2], ab = X[3], Y = X[4] || ""; if ((aa == "http:" && Y == ":80") || (aa == "https:" && Y == ":443")) { Y = "" } return aa + "//" + ab + Y } function B(X) { X = X.replace(F, "$1/"); if (!X.match(/^(http||https):\/\//)) { var Y = (X.substring(0, 1) === "/") ? "" : p.pathname; if (Y.substring(Y.length - 1) !== "/") { Y = Y.substring(0, Y.lastIndexOf("/") + 1) } X = p.protocol + "//" + p.host + Y + X } while (R.test(X)) { X = X.replace(R, "") } return X } function P(X, aa) { var ac = "", Z = X.indexOf("#"); if (Z !== -1) { ac = X.substring(Z); X = X.substring(0, Z) } var ab = []; for (var Y in aa) { if (aa.hasOwnProperty(Y)) { ab.push(Y + "=" + H(aa[Y])) } } return X + (y ? "#" : (X.indexOf("?") == -1 ? "?" : "&")) + ab.join("&") + ac } var S = (function (X) { X = X.substring(1).split("&"); var Z = {}, aa, Y = X.length; while (Y--) { aa = X[Y].split("="); Z[aa[0]] = k(aa[1]) } return Z } (/xdm_e=/.test(p.search) ? p.search : p.hash)); function t(X) { return typeof X === "undefined" } var O = function () { var Y = {}; var Z = { a: [1, 2, 3] }, X = '{"a":[1,2,3]}'; if (typeof JSON != "undefined" && typeof JSON.stringify === "function" && JSON.stringify(Z).replace((/\s/g), "") === X) { return JSON } if (Object.toJSON) { if (Object.toJSON(Z).replace((/\s/g), "") === X) { Y.stringify = Object.toJSON } } if (typeof String.prototype.evalJSON === "function") { Z = X.evalJSON(); if (Z.a && Z.a.length === 3 && Z.a[2] === 3) { Y.parse = function (aa) { return aa.evalJSON() } } } if (Y.stringify && Y.parse) { O = function () { return Y }; return Y } return null }; function T(X, Y, Z) { var ab; for (var aa in Y) { if (Y.hasOwnProperty(aa)) { if (aa in X) { ab = Y[aa]; if (typeof ab === "object") { T(X[aa], ab, Z) } else { if (!Z) { X[aa] = Y[aa] } } } else { X[aa] = Y[aa] } } } return X } function a() { var Y = d.body.appendChild(d.createElement("form")), X = Y.appendChild(d.createElement("input")); X.name = U + "TEST" + n; E = X !== Y.elements[X.name]; d.body.removeChild(Y) } function A(Y) { if (t(E)) { a() } var ac; if (E) { ac = d.createElement('<iframe name="' + Y.props.name + '"/>') } else { ac = d.createElement("IFRAME"); ac.name = Y.props.name } ac.id = ac.name = Y.props.name; delete Y.props.name; if (typeof Y.container == "string") { Y.container = d.getElementById(Y.container) } if (!Y.container) { T(ac.style, { position: "absolute", top: "-2000px", left: "0px" }); Y.container = d.body } var ab = Y.props.src; Y.props.src = "javascript:false"; T(ac, Y.props); ac.border = ac.frameBorder = 0; ac.allowTransparency = true; Y.container.appendChild(ac); if (Y.onLoad) { v(ac, "load", Y.onLoad) } if (Y.usePost) { var aa = Y.container.appendChild(d.createElement("form")), X; aa.target = ac.name; aa.action = ab; aa.method = "POST"; if (typeof (Y.usePost) === "object") { for (var Z in Y.usePost) { if (Y.usePost.hasOwnProperty(Z)) { if (E) { X = d.createElement('<input name="' + Z + '"/>') } else { X = d.createElement("INPUT"); X.name = Z } X.value = Y.usePost[Z]; aa.appendChild(X) } } } aa.submit(); aa.parentNode.removeChild(aa) } else { ac.src = ab } Y.props.src = ab; return ac } function V(aa, Z) { if (typeof aa == "string") { aa = [aa] } var Y, X = aa.length; while (X--) { Y = aa[X]; Y = new RegExp(Y.substr(0, 1) == "^" ? Y : ("^" + Y.replace(/(\*)/g, ".$1").replace(/\?/g, ".") + "$")); if (Y.test(Z)) { return true } } return false } function l(Z) { var ae = Z.protocol, Y; Z.isHost = Z.isHost || t(S.xdm_p); y = Z.hash || false; if (!Z.props) { Z.props = {} } if (!Z.isHost) { Z.channel = S.xdm_c.replace(/["'<>\\]/g, ""); Z.secret = S.xdm_s; Z.remote = S.xdm_e.replace(/["'<>\\]/g, ""); ae = S.xdm_p; if (Z.acl && !V(Z.acl, Z.remote)) { throw new Error("Access denied for " + Z.remote) } } else { Z.remote = B(Z.remote); Z.channel = Z.channel || "default" + n++; Z.secret = Math.random().toString(16).substring(2); if (t(ae)) { if (j(p.href) == j(Z.remote)) { ae = "4" } else { if (C(N, "postMessage") || C(d, "postMessage")) { ae = "1" } else { if (Z.swf && C(N, "ActiveXObject") && c()) { ae = "6" } else { if (navigator.product === "Gecko" && "frameElement" in N && navigator.userAgent.indexOf("WebKit") == -1) { ae = "5" } else { if (Z.remoteHelper) { ae = "2" } else { ae = "0" } } } } } } } Z.protocol = ae; switch (ae) { case "0": T(Z, { interval: 100, delay: 2000, useResize: true, useParent: false, usePolling: false }, true); if (Z.isHost) { if (!Z.local) { var ac = p.protocol + "//" + p.host, X = d.body.getElementsByTagName("img"), ad; var aa = X.length; while (aa--) { ad = X[aa]; if (ad.src.substring(0, ac.length) === ac) { Z.local = ad.src; break } } if (!Z.local) { Z.local = N } } var ab = { xdm_c: Z.channel, xdm_p: 0 }; if (Z.local === N) { Z.usePolling = true; Z.useParent = true; Z.local = p.protocol + "//" + p.host + p.pathname + p.search; ab.xdm_e = Z.local; ab.xdm_pa = 1 } else { ab.xdm_e = B(Z.local) } if (Z.container) { Z.useResize = false; ab.xdm_po = 1 } Z.remote = P(Z.remote, ab) } else { T(Z, { channel: S.xdm_c, remote: S.xdm_e, useParent: !t(S.xdm_pa), usePolling: !t(S.xdm_po), useResize: Z.useParent ? false : Z.useResize }) } Y = [new o.stack.HashTransport(Z), new o.stack.ReliableBehavior({}), new o.stack.QueueBehavior({ encode: true, maxLength: 4000 - Z.remote.length }), new o.stack.VerifyBehavior({ initiate: Z.isHost })]; break; case "1": Y = [new o.stack.PostMessageTransport(Z)]; break; case "2": Z.remoteHelper = B(Z.remoteHelper); Y = [new o.stack.NameTransport(Z), new o.stack.QueueBehavior(), new o.stack.VerifyBehavior({ initiate: Z.isHost })]; break; case "3": Y = [new o.stack.NixTransport(Z)]; break; case "4": Y = [new o.stack.SameOriginTransport(Z)]; break; case "5": Y = [new o.stack.FrameElementTransport(Z)]; break; case "6": if (!i) { c() } Y = [new o.stack.FlashTransport(Z)]; break } Y.push(new o.stack.QueueBehavior({ lazy: Z.lazy, remove: true })); return Y } function D(aa) { var ab, Z = { incoming: function (ad, ac) { this.up.incoming(ad, ac) }, outgoing: function (ac, ad) { this.down.outgoing(ac, ad) }, callback: function (ac) { this.up.callback(ac) }, init: function () { this.down.init() }, destroy: function () { this.down.destroy() } }; for (var Y = 0, X = aa.length; Y < X; Y++) { ab = aa[Y]; T(ab, Z, true); if (Y !== 0) { ab.down = aa[Y - 1] } if (Y !== X - 1) { ab.up = aa[Y + 1] } } return ab } function w(X) { X.up.down = X.down; X.down.up = X.up; X.up = X.down = null } T(o, { version: "2.4.17.1", query: S, stack: {}, apply: T, getJSONObject: O, whenReady: G, noConflict: e }); o.DomHelper = { on: v, un: x, requiresJSON: function (X) { if (!u(N, "JSON")) { d.write('<script type="text/javascript" src="' + X + '"><\/script>') } } }; (function () { var X = {}; o.Fn = { set: function (Y, Z) { X[Y] = Z }, get: function (Z, Y) { var aa = X[Z]; if (Y) { delete X[Z] } return aa } } } ()); o.Socket = function (Y) { var X = D(l(Y).concat([{ incoming: function (ab, aa) { Y.onMessage(ab, aa) }, callback: function (aa) { if (Y.onReady) { Y.onReady(aa) } } }])), Z = j(Y.remote); this.origin = j(Y.remote); this.destroy = function () { X.destroy() }; this.postMessage = function (aa) { X.outgoing(aa, Z) }; X.init() }; o.Rpc = function (Z, Y) { if (Y.local) { for (var ab in Y.local) { if (Y.local.hasOwnProperty(ab)) { var aa = Y.local[ab]; if (typeof aa === "function") { Y.local[ab] = { method: aa} } } } } var X = D(l(Z).concat([new o.stack.RpcBehavior(this, Y), { callback: function (ac) { if (Z.onReady) { Z.onReady(ac) } } }])); this.origin = j(Z.remote); this.destroy = function () { X.destroy() }; X.init() }; o.stack.SameOriginTransport = function (Y) { var Z, ab, aa, X; return (Z = { outgoing: function (ad, ae, ac) { aa(ad); if (ac) { ac() } }, destroy: function () { if (ab) { ab.parentNode.removeChild(ab); ab = null } }, onDOMReady: function () { X = j(Y.remote); if (Y.isHost) { T(Y.props, { src: P(Y.remote, { xdm_e: p.protocol + "//" + p.host + p.pathname, xdm_c: Y.channel, xdm_p: 4 }), name: U + Y.channel + "_provider" }); ab = A(Y); o.Fn.set(Y.channel, function (ac) { aa = ac; K(function () { Z.up.callback(true) }, 0); return function (ad) { Z.up.incoming(ad, X) } }) } else { aa = m().Fn.get(Y.channel, true)(function (ac) { Z.up.incoming(ac, X) }); K(function () { Z.up.callback(true) }, 0) } }, init: function () { G(Z.onDOMReady, Z) } }) }; o.stack.FlashTransport = function (aa) { var ac, X, ab, ad, Y, ae; function af(ah, ag) { K(function () { ac.up.incoming(ah, ad) }, 0) } function Z(ah) { var ag = aa.swf + "?host=" + aa.isHost; var aj = "easyXDM_swf_" + Math.floor(Math.random() * 10000); o.Fn.set("flash_loaded" + ah.replace(/[\-.]/g, "_"), function () { o.stack.FlashTransport[ah].swf = Y = ae.firstChild; var ak = o.stack.FlashTransport[ah].queue; for (var al = 0; al < ak.length; al++) { ak[al]() } ak.length = 0 }); if (aa.swfContainer) { ae = (typeof aa.swfContainer == "string") ? d.getElementById(aa.swfContainer) : aa.swfContainer } else { ae = d.createElement("div"); T(ae.style, h && aa.swfNoThrottle ? { height: "20px", width: "20px", position: "fixed", right: 0, top: 0} : { height: "1px", width: "1px", position: "absolute", overflow: "hidden", right: 0, top: 0 }); d.body.appendChild(ae) } var ai = "callback=flash_loaded" + ah.replace(/[\-.]/g, "_") + "&proto=" + b.location.protocol + "&domain=" + z(b.location.href) + "&port=" + f(b.location.href) + "&ns=" + I; ae.innerHTML = "<object height='20' width='20' type='application/x-shockwave-flash' id='" + aj + "' data='" + ag + "'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='" + ag + "'></param><param name='flashvars' value='" + ai + "'></param><embed type='application/x-shockwave-flash' FlashVars='" + ai + "' allowScriptAccess='always' wmode='transparent' src='" + ag + "' height='1' width='1'></embed></object>" } return (ac = { outgoing: function (ah, ai, ag) { Y.postMessage(aa.channel, ah.toString()); if (ag) { ag() } }, destroy: function () { try { Y.destroyChannel(aa.channel) } catch (ag) { } Y = null; if (X) { X.parentNode.removeChild(X); X = null } }, onDOMReady: function () { ad = aa.remote; o.Fn.set("flash_" + aa.channel + "_init", function () { K(function () { ac.up.callback(true) }) }); o.Fn.set("flash_" + aa.channel + "_onMessage", af); aa.swf = B(aa.swf); var ah = z(aa.swf); var ag = function () { o.stack.FlashTransport[ah].init = true; Y = o.stack.FlashTransport[ah].swf; Y.createChannel(aa.channel, aa.secret, j(aa.remote), aa.isHost); if (aa.isHost) { if (h && aa.swfNoThrottle) { T(aa.props, { position: "fixed", right: 0, top: 0, height: "20px", width: "20px" }) } T(aa.props, { src: P(aa.remote, { xdm_e: j(p.href), xdm_c: aa.channel, xdm_p: 6, xdm_s: aa.secret }), name: U + aa.channel + "_provider" }); X = A(aa) } }; if (o.stack.FlashTransport[ah] && o.stack.FlashTransport[ah].init) { ag() } else { if (!o.stack.FlashTransport[ah]) { o.stack.FlashTransport[ah] = { queue: [ag] }; Z(ah) } else { o.stack.FlashTransport[ah].queue.push(ag) } } }, init: function () { G(ac.onDOMReady, ac) } }) }; o.stack.PostMessageTransport = function (aa) { var ac, ad, Y, Z; function X(ae) { if (ae.origin) { return j(ae.origin) } if (ae.uri) { return j(ae.uri) } if (ae.domain) { return p.protocol + "//" + ae.domain } throw "Unable to retrieve the origin of the event" } function ab(af) { var ae = X(af); if (ae == Z && af.data.substring(0, aa.channel.length + 1) == aa.channel + " ") { ac.up.incoming(af.data.substring(aa.channel.length + 1), ae) } } return (ac = { outgoing: function (af, ag, ae) { Y.postMessage(aa.channel + " " + af, ag || Z); if (ae) { ae() } }, destroy: function () { x(N, "message", ab); if (ad) { Y = null; ad.parentNode.removeChild(ad); ad = null } }, onDOMReady: function () { Z = j(aa.remote); if (aa.isHost) { var ae = function (af) { if (af.data == aa.channel + "-ready") { Y = ("postMessage" in ad.contentWindow) ? ad.contentWindow : ad.contentWindow.document; x(N, "message", ae); v(N, "message", ab); K(function () { ac.up.callback(true) }, 0) } }; v(N, "message", ae); T(aa.props, { src: P(aa.remote, { xdm_e: j(p.href), xdm_c: aa.channel, xdm_p: 1 }), name: U + aa.channel + "_provider" }); ad = A(aa) } else { v(N, "message", ab); Y = ("postMessage" in N.parent) ? N.parent : N.parent.document; Y.postMessage(aa.channel + "-ready", Z); K(function () { ac.up.callback(true) }, 0) } }, init: function () { G(ac.onDOMReady, ac) } }) }; o.stack.FrameElementTransport = function (Y) { var Z, ab, aa, X; return (Z = { outgoing: function (ad, ae, ac) { aa.call(this, ad); if (ac) { ac() } }, destroy: function () { if (ab) { ab.parentNode.removeChild(ab); ab = null } }, onDOMReady: function () { X = j(Y.remote); if (Y.isHost) { T(Y.props, { src: P(Y.remote, { xdm_e: j(p.href), xdm_c: Y.channel, xdm_p: 5 }), name: U + Y.channel + "_provider" }); ab = A(Y); ab.fn = function (ac) { delete ab.fn; aa = ac; K(function () { Z.up.callback(true) }, 0); return function (ad) { Z.up.incoming(ad, X) } } } else { if (d.referrer && j(d.referrer) != S.xdm_e) { N.top.location = S.xdm_e } aa = N.frameElement.fn(function (ac) { Z.up.incoming(ac, X) }); Z.up.callback(true) } }, init: function () { G(Z.onDOMReady, Z) } }) }; o.stack.NameTransport = function (ab) { var ac; var ae, ai, aa, ag, ah, Y, X; function af(al) { var ak = ab.remoteHelper + (ae ? "#_3" : "#_2") + ab.channel; ai.contentWindow.sendMessage(al, ak) } function ad() { if (ae) { if (++ag === 2 || !ae) { ac.up.callback(true) } } else { af("ready"); ac.up.callback(true) } } function aj(ak) { ac.up.incoming(ak, Y) } function Z() { if (ah) { K(function () { ah(true) }, 0) } } return (ac = { outgoing: function (al, am, ak) { ah = ak; af(al) }, destroy: function () { ai.parentNode.removeChild(ai); ai = null; if (ae) { aa.parentNode.removeChild(aa); aa = null } }, onDOMReady: function () { ae = ab.isHost; ag = 0; Y = j(ab.remote); ab.local = B(ab.local); if (ae) { o.Fn.set(ab.channel, function (al) { if (ae && al === "ready") { o.Fn.set(ab.channel, aj); ad() } }); X = P(ab.remote, { xdm_e: ab.local, xdm_c: ab.channel, xdm_p: 2 }); T(ab.props, { src: X + "#" + ab.channel, name: U + ab.channel + "_provider" }); aa = A(ab) } else { ab.remoteHelper = ab.remote; o.Fn.set(ab.channel, aj) } var ak = function () { var al = ai || this; x(al, "load", ak); o.Fn.set(ab.channel + "_load", Z); (function am() { if (typeof al.contentWindow.sendMessage == "function") { ad() } else { K(am, 50) } } ()) }; ai = A({ props: { src: ab.local + "#_4" + ab.channel }, onLoad: ak }) }, init: function () { G(ac.onDOMReady, ac) } }) }; o.stack.HashTransport = function (Z) { var ac; var ah = this, af, aa, X, ad, am, ab, al; var ag, Y; function ak(ao) { if (!al) { return } var an = Z.remote + "#" + (am++) + "_" + ao; ((af || !ag) ? al.contentWindow : al).location = an } function ae(an) { ad = an; ac.up.incoming(ad.substring(ad.indexOf("_") + 1), Y) } function aj() { if (!ab) { return } var an = ab.location.href, ap = "", ao = an.indexOf("#"); if (ao != -1) { ap = an.substring(ao) } if (ap && ap != ad) { ae(ap) } } function ai() { aa = setInterval(aj, X) } return (ac = { outgoing: function (an, ao) { ak(an) }, destroy: function () { N.clearInterval(aa); if (af || !ag) { al.parentNode.removeChild(al) } al = null }, onDOMReady: function () { af = Z.isHost; X = Z.interval; ad = "#" + Z.channel; am = 0; ag = Z.useParent; Y = j(Z.remote); if (af) { T(Z.props, { src: Z.remote, name: U + Z.channel + "_provider" }); if (ag) { Z.onLoad = function () { ab = N; ai(); ac.up.callback(true) } } else { var ap = 0, an = Z.delay / 50; (function ao() { if (++ap > an) { throw new Error("Unable to reference listenerwindow") } try { ab = al.contentWindow.frames[U + Z.channel + "_consumer"] } catch (aq) { } if (ab) { ai(); ac.up.callback(true) } else { K(ao, 50) } } ()) } al = A(Z) } else { ab = N; ai(); if (ag) { al = parent; ac.up.callback(true) } else { T(Z, { props: { src: Z.remote + "#" + Z.channel + new Date(), name: U + Z.channel + "_consumer" }, onLoad: function () { ac.up.callback(true) } }); al = A(Z) } } }, init: function () { G(ac.onDOMReady, ac) } }) }; o.stack.ReliableBehavior = function (Y) { var aa, ac; var ab = 0, X = 0, Z = ""; return (aa = { incoming: function (af, ad) { var ae = af.indexOf("_"), ag = af.substring(0, ae).split(","); af = af.substring(ae + 1); if (ag[0] == ab) { Z = ""; if (ac) { ac(true); ac = null } } if (af.length > 0) { aa.down.outgoing(ag[1] + "," + ab + "_" + Z, ad); if (X != ag[1]) { X = ag[1]; aa.up.incoming(af, ad) } } }, outgoing: function (af, ad, ae) { Z = af; ac = ae; aa.down.outgoing(X + "," + (++ab) + "_" + af, ad) } }) }; o.stack.QueueBehavior = function (Z) { var ac, ad = [], ag = true, aa = "", af, X = 0, Y = false, ab = false; function ae() { if (Z.remove && ad.length === 0) { w(ac); return } if (ag || ad.length === 0 || af) { return } ag = true; var ah = ad.shift(); ac.down.outgoing(ah.data, ah.origin, function (ai) { ag = false; if (ah.callback) { K(function () { ah.callback(ai) }, 0) } ae() }) } return (ac = { init: function () { if (t(Z)) { Z = {} } if (Z.maxLength) { X = Z.maxLength; ab = true } if (Z.lazy) { Y = true } else { ac.down.init() } }, callback: function (ai) { ag = false; var ah = ac.up; ae(); ah.callback(ai) }, incoming: function (ak, ai) { if (ab) { var aj = ak.indexOf("_"), ah = parseInt(ak.substring(0, aj), 10); aa += ak.substring(aj + 1); if (ah === 0) { if (Z.encode) { aa = k(aa) } ac.up.incoming(aa, ai); aa = "" } } else { ac.up.incoming(ak, ai) } }, outgoing: function (al, ai, ak) { if (Z.encode) { al = H(al) } var ah = [], aj; if (ab) { while (al.length !== 0) { aj = al.substring(0, X); al = al.substring(aj.length); ah.push(aj) } while ((aj = ah.shift())) { ad.push({ data: ah.length + "_" + aj, origin: ai, callback: ah.length === 0 ? ak : null }) } } else { ad.push({ data: al, origin: ai, callback: ak }) } if (Y) { ac.down.init() } else { ae() } }, destroy: function () { af = true; ac.down.destroy() } }) }; o.stack.VerifyBehavior = function (ab) { var ac, aa, Y, Z = false; function X() { aa = Math.random().toString(16).substring(2); ac.down.outgoing(aa) } return (ac = { incoming: function (af, ad) { var ae = af.indexOf("_"); if (ae === -1) { if (af === aa) { ac.up.callback(true) } else { if (!Y) { Y = af; if (!ab.initiate) { X() } ac.down.outgoing(af) } } } else { if (af.substring(0, ae) === Y) { ac.up.incoming(af.substring(ae + 1), ad) } } }, outgoing: function (af, ad, ae) { ac.down.outgoing(aa + "_" + af, ad, ae) }, callback: function (ad) { if (ab.initiate) { X() } } }) }; o.stack.RpcBehavior = function (ad, Y) { var aa, af = Y.serializer || O(); var ae = 0, ac = {}; function X(ag) { ag.jsonrpc = "2.0"; aa.down.outgoing(af.stringify(ag)) } function ab(ag, ai) { var ah = Array.prototype.slice; return function () { var aj = arguments.length, al, ak = { method: ai }; if (aj > 0 && typeof arguments[aj - 1] === "function") { if (aj > 1 && typeof arguments[aj - 2] === "function") { al = { success: arguments[aj - 2], error: arguments[aj - 1] }; ak.params = ah.call(arguments, 0, aj - 2) } else { al = { success: arguments[aj - 1] }; ak.params = ah.call(arguments, 0, aj - 1) } ac["" + (++ae)] = al; ak.id = ae } else { ak.params = ah.call(arguments, 0) } if (ag.namedParams && ak.params.length === 1) { ak.params = ak.params[0] } X(ak) } } function Z(an, am, ai, al) { if (!ai) { if (am) { X({ id: am, error: { code: -32601, message: "Procedure not found."} }) } return } var ak, ah; if (am) { ak = function (ao) { ak = q; X({ id: am, result: ao }) }; ah = function (ao, ap) { ah = q; var aq = { id: am, error: { code: -32099, message: ao} }; if (ap) { aq.error.data = ap } X(aq) } } else { ak = ah = q } if (!r(al)) { al = [al] } try { var ag = ai.method.apply(ai.scope, al.concat([ak, ah])); if (!t(ag)) { ak(ag) } } catch (aj) { ah(aj.message) } } return (aa = { incoming: function (ah, ag) { var ai = af.parse(ah); if (ai.method) { if (Y.handle) { Y.handle(ai, X) } else { Z(ai.method, ai.id, Y.local[ai.method], ai.params) } } else { var aj = ac[ai.id]; if (ai.error) { if (aj.error) { aj.error(ai.error) } } else { if (aj.success) { aj.success(ai.result) } } delete ac[ai.id] } }, init: function () { if (Y.remote) { for (var ag in Y.remote) { if (Y.remote.hasOwnProperty(ag)) { ad[ag] = ab(Y.remote[ag], ag) } } } aa.down.init() }, destroy: function () { for (var ag in Y.remote) { if (Y.remote.hasOwnProperty(ag) && ad.hasOwnProperty(ag)) { delete ad[ag] } } aa.down.destroy() } }) }; b.easyXDM = o })(window, document, location, window.setTimeout, decodeURIComponent, encodeURIComponent);
/*
Resorts World Manila API v.1.0.4
https://phoenix.rwmanila.com
(c) 2013 by ITApplicationSupport@rwmanila.com. All rights reserved.
*/
(function (phoenix, undefined) {
    // Public Properties
    phoenix.ver = "1.0.4";
    phoenix.userId = "test.user";
    phoenix.apiKey = "c9d525ea08f16a40082d069d30d4a7e92549e4b4";
    phoenix.server = "https://phoenix.rwmanila.com/api";
    // Private Properties
    var publicUserId = "public",
        publicApiKey = "7CE766FE1473813B97C148EB9F7BD49514B9ECD0",
        _xhr;
    try {
        _xhr = new easyXDM.Rpc({
            local: "/ie6bridge.html",
            swf: phoenix.server + "/../Scripts/easyxdm.swf",
            remote: phoenix.server + "/../cors",
            remoteHelper: phoenix.server + "/../Scripts/name.html"
        }, {
            remote: { request: {} }
        });
    } catch (e) {
        _xhr = null;
    }
    // Public Methods
    phoenix.public = function publicF(jsonRequest, successCallback) {
        phoenix.send(jsonRequest, successCallback, publicUserId, publicApiKey);
    }
    phoenix.send = function sendF(jsonRequest, successCallback, UserId, ApiKey) {
        if (!UserId) UserId = phoenix.userId;
        if (!ApiKey) ApiKey = phoenix.apiKey;
        var t = (new Date()).toUTCString(),
            r = generateRandom(),
            m = "POST " + t + " " + r + " " + getPath(phoenix.server),
            s = genSignature(ApiKey, m);
        if ((!_xhr) || (UserId === 'debug')) {
            var e = new XMLHttpRequest();
            e.open("POST", phoenix.server, true);
            e.onreadystatechange = function () {
                if (this.readyState == XMLHttpRequest.DONE) {
                    if (successCallback) {
                        successCallback(this.responseText)
                    }
                }
            }
            e.setRequestHeader("Accept", "text/html,application/json;q=0.9,*/*;q=0.8");
            e.setRequestHeader("content-type", "application/json");
            e.setRequestHeader("Timestamp", t);
            e.setRequestHeader("Authentication", UserId + ":" + s);
            e.setRequestHeader("Random", r);
            e.send(JSON.stringify(jsonRequest));
        } else {
            _xhr.request({
                url: phoenix.server,
                method: "POST",
                headers: {
                    "Accept": "text/html,application/json;q=0.9,*/*;q=0.8",
                    "Content-Type": "application/json",
                    "Timestamp": t,
                    "Authentication": UserId + ":" + s,
                    "Random": r
                },
                data: JSON.stringify(jsonRequest)
            }, function resF(rpcdata) {
                if (successCallback) {
                    successCallback(rpcdata.data);
                }
            });
        }
    };
    // Private Methods
    var trim = function trimF(s) {
        return s.replace(/^\s+|\s+$/g, '');
    }
    var genSignature = function genSignatureF(apikey, message) {
        return CryptoJS.enc.Base64.stringify(
            CryptoJS.HmacSHA256(message, apikey.toUpperCase()));
    }
    var getPath = function getPathF(url) {
        var s, l = document.createElement("a");
        l.href = url;
        s = l.pathname;
        if (s.charAt(0) !== '/')
            s = '/' + s;
        return trim(s);
    }
    var generateRandom = function generateRandomF() {
        var d = new Date().getTime();
        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            var r = (d + Math.random() * 16) % 16 | 0;
            d = Math.floor(d / 16);
            return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16);
        });
        return uuid;
    }
} (window.phoenix = window.phoenix || {}));